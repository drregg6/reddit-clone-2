(this["webpackJsonpReddit-Clone-2"]=this["webpackJsonpReddit-Clone-2"]||[]).push([[0],{41:function(e,t,a){e.exports=a(64)},47:function(e,t,a){},64:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(27),c=a.n(s),o=(a(46),a(47),a(6)),i=a(10),l=a(31),u=a.n(l);u.a.initializeApp({apiKey:"AIzaSyAqk7zFPSK034_4RN--GO6RRNIJGAX6AH8",authDomain:"reddit-clone-2-104ec.firebaseapp.com",databaseURL:"https://reddit-clone-2-104ec.firebaseio.com",projectId:"reddit-clone-2-104ec",storageBucket:"reddit-clone-2-104ec.appspot.com",messagingSenderId:"1081257686534",appId:"1:1081257686534:web:55d3cd74066a82e3413587"});var d=u.a,m=a(4),p=a(2),v=a(3),f=a.n(v),b=a(5),E=d.firestore();E.settings({});var h=E,g=function(){return function(){var e=Object(b.a)(f.a.mark((function e(t){var a,n,r,s,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=new d.auth.GoogleAuthProvider,e.next=4,d.auth().signInWithPopup(a);case 4:n=e.sent,r=n.user,s={name:r.displayName,id:r.uid,image:r.photoURL},c=Object(p.a)(Object(p.a)({},s),{},{created_at:d.firestore.FieldValue.serverTimestamp()}),h.collection("users").doc(c.id).set(c),t({type:"LOGIN_USER",payload:s}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}()},N=function(){return function(){var e=Object(b.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.auth().signOut();case 3:t({type:"LOGOUT_USER"}),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()},O=function(){return function(){var e=Object(b.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=[],e.next=4,h.collection("subreddits").get();case 4:e.sent.forEach((function(e){a.push(e.data())})),t({type:"GET_SUBREDDITS",payload:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},_=Object(m.b)((function(e){return{auth:e.auth,subreddits:e.subreddits}}),{login:g,logout:N,fetchSubreddits:O})((function(e){var t=e.login,a=e.logout,s=e.fetchSubreddits,c=e.subreddits.subreddits,i=e.auth,l=i.currentUser,u=i.isLoggedIn;return Object(n.useEffect)((function(){s()}),[s]),r.a.createElement("nav",{className:"navbar is-light",role:"navigation","aria-label":"dropdown navigation"},r.a.createElement("div",{className:"navbar-brand"},r.a.createElement(o.b,{className:"navbar-item",to:"/"},"Dave Regg's Personal Reddit"),r.a.createElement("a",{href:"!#",role:"button",className:"navbar-burger burger","aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample"},r.a.createElement("span",{"aria-hidden":"true"}),r.a.createElement("span",{"aria-hidden":"true"}),r.a.createElement("span",{"aria-hidden":"true"}))),r.a.createElement("div",{id:"navbarBasicExample",className:"navbar-menu"},r.a.createElement("div",{className:"navbar-start"},r.a.createElement("div",{className:"navbar-item has-dropdown is-hoverable"},r.a.createElement(o.b,{to:"/r/index",className:"navbar-link is-arrowless"},"Subreddits"),r.a.createElement("div",{className:"navbar-dropdown"},null!==c&&c.map((function(e){return r.a.createElement(o.b,{key:e.id,className:"navbar-item is-capitalized",to:"/r/".concat(e.name)},e.name)})),u&&r.a.createElement(o.b,{className:"navbar-item",to:"/create-a-subreddit"},"Create a Subreddit"))),r.a.createElement("div",{className:"navbar-item"},u&&r.a.createElement(o.b,{to:"/create-a-subreddit"},"Create a Subreddit"))),r.a.createElement("div",{className:"navbar-end"},u?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"navbar-item"},r.a.createElement(o.b,{to:"/u/".concat(l.id),className:"button is-light is-info"},l.name)),r.a.createElement("div",{className:"navbar-item"},r.a.createElement("button",{className:"button is-danger",onClick:function(){return a()}},"Logout"))):r.a.createElement("div",{className:"navbar-item"},r.a.createElement("button",{className:"button is-primary",onClick:function(){return t()}},r.a.createElement("strong",null,"Login with Google"))))))})),j=function(){return r.a.createElement("header",null,r.a.createElement(_,null))},y=Object(m.b)((function(e){return{auth:e.auth}}),null)((function(e){var t=e.auth,a=t.isLoggedIn,n=t.currentUser;return r.a.createElement("footer",{className:"footer"},r.a.createElement("div",{className:"columns"},r.a.createElement("div",{className:"column"},r.a.createElement("nav",{className:"nav"},r.a.createElement("div",{className:"navbar-item"},r.a.createElement(o.b,{to:"/"},"Home")),r.a.createElement("div",{className:"navbar-item"},r.a.createElement(o.b,{to:"/r/index"},"Subreddits")),a&&r.a.createElement("div",{className:"navbar-item"},r.a.createElement(o.b,{to:"/create-a-subreddit"},"Create a Subreddit")))),r.a.createElement("div",{className:"column"},r.a.createElement("p",null,"\xa9",(new Date).getFullYear()," ",r.a.createElement("a",{href:"http://www.daveregg.com",rel:"noopener noreferrer",target:"_blank"},"Dave Regg"))),r.a.createElement("div",{className:"column is-2"},a?r.a.createElement("nav",{className:"nav"},r.a.createElement("div",{className:"navbar-item"},r.a.createElement(o.b,{to:"/u/".concat(n.id),className:"button is-light is-info mb-1"},n.name)),r.a.createElement("div",{className:"navbar-item"},r.a.createElement("button",{className:"button is-danger mt-1",onClick:function(){return N()}},"Logout"))):r.a.createElement("button",{className:"button is-info",onClick:function(){return g()}},"Login with Google"))))})),x=a(40),w=Object(m.b)((function(e){return{auth:e.auth}}),null)((function(e){var t=e.component,a=e.auth,n=a.isLoggedIn,s=a.isLoading,c=Object(x.a)(e,["component","auth"]);return r.a.createElement(i.b,Object.assign({},c,{render:function(e){return!n&&s?r.a.createElement(i.a,{to:"/"}):r.a.createElement(t,e)}}))})),U=function(e){return r.a.createElement("div",{className:"container my-5"},e.children)},S=function(e){e*=1e3;var t=Math.floor((new Date-e)/1e3),a=Math.floor(t/31536e3);return a>1?"".concat(a," years"):(a=Math.floor(t/2592e3))>1?"".concat(a," months"):(a=Math.floor(t/86400))>1?"".concat(a," days"):(a=Math.floor(t/3600))>1?"".concat(a," hours"):(a=Math.floor(t/60))>1?"".concat(a," minutes"):"".concat(isNaN(Math.floor(t))?"0":Math.floor(t)," seconds")},T=function(){return function(){var e=Object(b.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=[],e.next=4,h.collection("votes").get();case 4:e.sent.forEach((function(e){a.push(e.data())})),t({type:"GET_VOTES",payload:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},C=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(){var r=Object(b.a)(f.a.mark((function r(s){var c,o;return f.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o={userUpvoted:!1,userDownvoted:!1},r.prev=1,r.next=4,h.collection("votes").where("post_id","==",t).where("user_upvotes","array-contains",a).get();case 4:return r.sent.forEach((function(e){e&&(o.userUpvoted=!0)})),r.next=8,h.collection("votes").where("post_id","==",t).where("user_downvotes","array-contains",a).get();case 8:if(r.sent.forEach((function(e){e&&(o.userDownvoted=!0)})),!o.userUpvoted){r.next=15;break}return r.next=13,h.collection("votes").doc(e).update({user_upvotes:d.firestore.FieldValue.arrayRemove(a),updated_at:d.firestore.FieldValue.serverTimestamp(),votes:d.firestore.FieldValue.increment(-1)});case 13:r.next=22;break;case 15:if(!o.userDownvoted){r.next=20;break}return r.next=18,h.collection("votes").doc(e).update({user_upvotes:d.firestore.FieldValue.arrayUnion(a),user_downvotes:d.firestore.FieldValue.arrayRemove(a),updated_at:d.firestore.FieldValue.serverTimestamp(),votes:d.firestore.FieldValue.increment(2)});case 18:r.next=22;break;case 20:return r.next=22,h.collection("votes").doc(e).update({user_upvotes:d.firestore.FieldValue.arrayUnion(a),updated_at:d.firestore.FieldValue.serverTimestamp(),votes:d.firestore.FieldValue.increment(1)});case 22:return r.next=24,h.collection("votes").doc(e).get().then((function(e){c=e.data()}));case 24:n&&(s({type:"CLEAR_VOTE"}),s({type:"GET_VOTE",payload:c})),s({type:"ADD_VOTE",payload:c}),r.next=31;break;case 28:r.prev=28,r.t0=r.catch(1),console.error(r.t0.message);case 31:case"end":return r.stop()}}),r,null,[[1,28]])})));return function(e){return r.apply(this,arguments)}}()},k=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(){var r=Object(b.a)(f.a.mark((function r(s){var c,o;return f.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o={userUpvoted:!1,userDownvoted:!1},r.prev=1,r.next=4,h.collection("votes").where("post_id","==",t).where("user_upvotes","array-contains",a).get();case 4:return r.sent.forEach((function(e){e&&(o.userUpvoted=!0)})),r.next=8,h.collection("votes").where("post_id","==",t).where("user_downvotes","array-contains",a).get();case 8:if(r.sent.forEach((function(e){e&&(o.userDownvoted=!0)})),!o.userUpvoted){r.next=15;break}return r.next=13,h.collection("votes").doc(e).update({user_upvotes:d.firestore.FieldValue.arrayRemove(a),user_downvotes:d.firestore.FieldValue.arrayUnion(a),updated_at:d.firestore.FieldValue.serverTimestamp(),votes:d.firestore.FieldValue.increment(-2)});case 13:r.next=22;break;case 15:if(!o.userDownvoted){r.next=20;break}return r.next=18,h.collection("votes").doc(e).update({user_downvotes:d.firestore.FieldValue.arrayRemove(a),updated_at:d.firestore.FieldValue.serverTimestamp(),votes:d.firestore.FieldValue.increment(1)});case 18:r.next=22;break;case 20:return r.next=22,h.collection("votes").doc(e).update({user_downvotes:d.firestore.FieldValue.arrayUnion(a),updated_at:d.firestore.FieldValue.serverTimestamp(),votes:d.firestore.FieldValue.increment(-1)});case 22:return r.next=24,h.collection("votes").doc(e).get().then((function(e){c=e.data()}));case 24:n&&(s({type:"CLEAR_VOTE"}),s({type:"GET_VOTE",payload:c})),s({type:"REMOVE_VOTE",payload:c}),r.next=31;break;case 28:r.prev=28,r.t0=r.catch(1),console.error(r.t0.message);case 31:case"end":return r.stop()}}),r,null,[[1,28]])})));return function(e){return r.apply(this,arguments)}}()},L=Object(m.b)(null,{upvote:C,downvote:k})((function(e){var t=e.postId,a=e.voteId,n=e.upvote,s=e.downvote,c=e.votes,o=e.userUpvotes,i=e.userDownvotes,l=e.currentUser,u=a,d=t,m=l.id;return r.a.createElement("div",{className:"votes"},r.a.createElement("button",{className:"button is-success is-small ".concat(-1!==o.indexOf(l.id)&&"is-light"),disabled:0===Object.entries(l).length,onClick:function(){return n(u,d,m)}},"Upvote"),r.a.createElement("span",{className:"vote-amount my-1"},c),r.a.createElement("button",{className:"button is-danger is-small ".concat(-1!==i.indexOf(l.id)&&"is-light"),disabled:0===Object.entries(l).length,onClick:function(){return s(u,d,m)}},"Downvote"))})),D=function(e){var t,a,n,s=e.post,c=e.users,i=e.votes,l=e.currentUser,u=e.subreddits,d=(t=s.user_id,c.filter((function(e){return e.id===t}))[0]),m=(a=s.subreddit_id,u.filter((function(e){return e.id===a}))[0]),p=(n=s.id,i.filter((function(e){return e.post_id===n}))[0]);return r.a.createElement("div",{key:s.id,className:"media"},void 0!==p&&r.a.createElement("div",{className:"media-left"},r.a.createElement(L,{voteId:p.id,postId:p.post_id,votes:p.votes,userUpvotes:p.user_upvotes,userDownvotes:p.user_downvotes,currentUser:l})),""!==s.url&&r.a.createElement("div",{className:"media-left align-center"},r.a.createElement("figure",{className:"image is-64x64"},r.a.createElement("img",{src:s.url,alt:""}))),r.a.createElement("div",{className:"media-content post-content"},r.a.createElement("p",null,m&&r.a.createElement(o.b,{to:"/r/".concat(m.name,"/").concat(s.id)},s.title)),r.a.createElement("p",null,s.desc),r.a.createElement("div",{className:"level"},r.a.createElement("div",{className:"level-item has-text-centered is-size-7"},m&&r.a.createElement(o.b,{to:"/r/".concat(m.name)},m.name)),r.a.createElement("div",{className:"level-item has-text-centered is-size-7"},"Created ",S(s.created_at.seconds)),r.a.createElement("div",{className:"level-item has-text-centered is-size-7"},"Updated ",S(s.updated_at.seconds)),r.a.createElement("div",{className:"level-item has-text-centered is-size-7"},d&&r.a.createElement(o.b,{to:"/u/".concat(d.id)},d.name)))))},R=function(e){var t=e.posts,a=e.users,n=e.subreddits,s=e.currentUser,c=e.votes;return r.a.createElement(U,null,r.a.createElement("h1",{className:"mb-6 has-text-centered"},"Check out the latest posts"),0!==t.length&&t.map((function(e){return r.a.createElement(D,{key:e.id,post:e,users:a,subreddits:n,votes:c,currentUser:s})})))},P=function(){return function(){var e=Object(b.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],e.prev=1,t({type:"CLEAR_POSTS"}),e.next=5,h.collection("posts").get();case 5:e.sent.forEach((function(e){a.push(e.data())})),a=a.sort((function(e,t){return t.created_at-e.created_at})),t({type:"GET_POSTS",payload:a}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.error(e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}()},V=function(e,t){return function(){var a=Object(b.a)(f.a.mark((function a(n){return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,h.collection("comments").where("post_id","==",e).get().then((function(e){var t=h.batch();return e.forEach((function(e){t.delete(e.ref)})),t.commit()}));case 3:return a.next=5,h.collection("posts").doc(e).delete();case 5:return n({type:"DELETE_POST",payload:e}),a.next=8,h.collection("votes").where("post_id","==",e).get().then((function(e){var t=h.batch();return e.forEach((function(e){t.delete(e.ref)})),t.commit()}));case 8:n({type:"DELETE_VOTE",payload:t}),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(0),console.error(a.t0.message);case 14:case"end":return a.stop()}}),a,null,[[0,11]])})));return function(e){return a.apply(this,arguments)}}()},A=function(){return function(){var e=Object(b.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],e.prev=1,e.next=4,h.collection("users").get();case 4:e.sent.forEach((function(e){a.push(e.data())})),t({type:"GET_USERS",payload:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},F=Object(m.b)((function(e){return{auth:e.auth,posts:e.posts,users:e.users,subreddits:e.subreddits,votes:e.votes}}),{login:g,fetchVotes:T,fetchAllPosts:P,fetchSubreddits:O,fetchUsers:A})((function(e){var t=e.login,a=e.fetchAllPosts,s=e.fetchSubreddits,c=e.fetchVotes,o=e.fetchUsers,i=e.posts.posts,l=e.auth,u=l.currentUser,d=l.isLoggedIn,m=e.users.users,p=e.subreddits.subreddits,v=e.votes.votes;return Object(n.useEffect)((function(){a(),s(),o(),c()}),[a,s,o,c]),r.a.createElement("section",null,r.a.createElement("div",{className:"hero is-info is-large"},r.a.createElement("div",{className:"hero-body"},r.a.createElement("div",{className:"container"},r.a.createElement("h1",{className:"title"},"Dave Regg's Personal Reddit"),r.a.createElement("h2",{className:"subtitle is-size-6"},"Welcome to the best Reddit clone you'll ever see!"),!d&&r.a.createElement("button",{className:"button is-outlined",onClick:function(){return t()}},"Login")))),r.a.createElement(R,{posts:i.slice(0,25),users:m,subreddits:p,votes:v,currentUser:u}))})),I=a(8),G=function(e){var t=e.deletePost,a=e.currentUser,n=e.subreddit,s=e.post_id,c=e.user_id,i=e.url,l=e.title,u=e.desc,d=e.updated_at,m=e.author,p=e.postVotes,v=p.voteId,f=p.userUpvotes,b=p.userDownvotes,E=p.votes,h=v;return r.a.createElement("div",{className:"media",key:s},r.a.createElement("div",{className:"media-left"},r.a.createElement(L,{voteId:h,postId:s,votes:E,userUpvotes:f,userDownvotes:b,currentUser:a})),""!==i&&r.a.createElement("div",{className:"media-left align-center"},r.a.createElement("figure",{className:"image is-64x64"},r.a.createElement("a",{href:i,target:"_blank",rel:"noopener noreferrer"},r.a.createElement("img",{src:i,alt:""})))),r.a.createElement("div",{className:"media-content post-content"},r.a.createElement("p",{className:"has-text-weight-bold"},r.a.createElement(o.b,{to:"/r/".concat(n,"/").concat(s)},l)),r.a.createElement("p",null,u),r.a.createElement("div",{className:"level is-size-7"},r.a.createElement("div",{className:"level-right"},r.a.createElement("div",{className:"level-item"},r.a.createElement("span",{className:"has-text-weight-bold mr-1"},"Updated:")," ",S(d.seconds)),r.a.createElement("div",{className:"level-item"},r.a.createElement("figure",{className:"image is-24x24 mr-2"},r.a.createElement("img",{className:"is-rounded",src:m.image,alt:""})),m.name)))),c===a.id&&r.a.createElement("div",{className:"media-right"},r.a.createElement("button",{className:"delete",onClick:function(){return t(s,h)}},"X")))},M=function(e){var t=e.search,a=e.subreddit,s=e.deletePost,c=e.currentUser,o=e.users,i=e.votes,l=e.posts,u=Object(n.useState)(!1),d=Object(I.a)(u,2),m=d[0],p=d[1],v=Object(n.useState)(!0),f=Object(I.a)(v,2),b=f[0],E=f[1],h=function(e){return o.filter((function(t){return t.id===e}))[0]},g=function(e){return i.filter((function(t){return t.post_id===e}))[0]},N=function(e){return l.filter((function(t){return t.id===e}))[0]};return r.a.createElement("section",null,r.a.createElement("div",{className:"buttons mb-5"},r.a.createElement("button",{className:"mr-5 is-small button is-primary ".concat(m&&"is-light"),onClick:function(){return p(!0),void E(!1)},disabled:m},"Sort By Most Votes"),r.a.createElement("button",{className:"ml-5 is-small button is-info ".concat(b&&"is-light"),onClick:function(){return E(!0),void p(!1)},disabled:b},"Sort By New")),r.a.createElement("div",null,l?m?function(e){return e.map((function(e){return g(e.id)})).sort((function(e,t){return t.votes-e.votes})).map((function(e){return e?N(e.post_id):null}))}(l).map((function(e){var t={voteId:"",userUpvotes:[],userDownvotes:[],votes:0};t.voteId=void 0!==g(e.id)&&g(e.id).id,t.votes=void 0!==g(e.id)?g(e.id).votes:"0",t.userUpvotes=void 0!==g(e.id)?g(e.id).user_upvotes:[],t.userDownvotes=void 0!==g(e.id)?g(e.id).user_downvotes:[];var n=void 0!==h(e.user_id)?h(e.user_id):{name:"Anonymous",image:"https://bulma.io/images/placeholders/96x96.png",id:"rand0mnumb3rgen3r4t0r"};return r.a.createElement(G,{key:e.id,currentUser:c,post_id:e.id,user_id:e.user_id,subreddit:a,url:e.url,title:e.title,desc:e.desc,updated_at:e.updated_at,author:n,postVotes:t})})):function(e){if(""!==t){var a=new RegExp(t,"gi");return e.filter((function(e){return(e.title+e.desc).match(a)}))}return e}(l).map((function(e){var t={voteId:"",userUpvotes:[],userDownvotes:[],votes:0};t.voteId=void 0!==g(e.id)&&g(e.id).id,t.votes=void 0!==g(e.id)?g(e.id).votes:"0",t.userUpvotes=void 0!==g(e.id)?g(e.id).user_upvotes:[],t.userDownvotes=void 0!==g(e.id)?g(e.id).user_downvotes:[];var n=void 0!==h(e.user_id)?h(e.user_id):{name:"Anonymous",image:"https://bulma.io/images/placeholders/96x96.png"};return r.a.createElement(G,{key:e.id,deletePost:s,currentUser:c,post_id:e.id,user_id:e.user_id,subreddit:a,url:e.url,title:e.title,desc:e.desc,updated_at:e.updated_at,author:n,postVotes:t})})):r.a.createElement("h1",null,"Loading")))},B=a(14),z=Object(m.b)(null,{createPost:function(e){return function(){var t=Object(b.a)(f.a.mark((function t(a){var n,r,s,c;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=h.collection("posts").doc(),r=h.collection("votes").doc(),(s=Object(p.a)({},e)).id=n.id,s.created_at=d.firestore.FieldValue.serverTimestamp(),s.updated_at=d.firestore.FieldValue.serverTimestamp(),s.user_id=d.auth().currentUser.uid,(c={votes:1}).user_upvotes=[],c.user_downvotes=[],c.id=r.id,c.subreddit_id=s.subreddit_id,c.updated_at=d.firestore.FieldValue.serverTimestamp(),c.user_upvotes.push(d.auth().currentUser.uid),c.post_id=s.id,t.prev=15,t.next=18,h.collection("posts").doc(s.id).set(s);case 18:return t.next=20,h.collection("votes").doc(c.id).set(c);case 20:a({type:"CREATE_POST",payload:s}),a({type:"ADD_VOTES",payload:c}),a({}),t.next=28;break;case 25:t.prev=25,t.t0=t.catch(15),console.error(t.t0.message);case 28:case"end":return t.stop()}}),t,null,[[15,25]])})));return function(e){return t.apply(this,arguments)}}()}})((function(e){var t=e.createPost,a=e.toggleShowForm,s=e.subreddit,c=Object(n.useState)({title:"",desc:"",url:""}),o=Object(I.a)(c,2),i=o[0],l=o[1],u=i.title,d=i.desc,m=i.url,v=function(e){l(Object(p.a)(Object(p.a)({},i),{},Object(B.a)({},e.target.name,e.target.value)))};return r.a.createElement("form",{className:"post-form",onSubmit:function(e){return function(e){e.preventDefault();var n=Object(p.a)(Object(p.a)({},i),{},{subreddit_id:s});t(n),l({title:"",desc:"",url:""}),a(!1)}(e)}},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{className:"input",placeholder:"Title",type:"text",value:u,name:"title",onChange:function(e){return v(e)}}))),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("textarea",{className:"textarea",placeholder:"Desc",type:"text",value:d,name:"desc",onChange:function(e){return v(e)}}))),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{className:"input",placeholder:"URL",type:"text",value:m,name:"url",onChange:function(e){return v(e)}}))),r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button is-primary"},"Create Post")))})),H=Object(m.b)((function(e){return{subreddits:e.subreddits,posts:e.posts,users:e.users,votes:e.votes,auth:e.auth}}),{deletePost:V,deleteSubreddit:function(e,t){return function(){var a=Object(b.a)(f.a.mark((function a(n){return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!window.confirm("Are you sure? This action cannot be undone!")){a.next=17;break}return a.prev=1,a.next=4,h.collection("posts").where("subreddit_id","==",e).get().then((function(e){var t=h.batch();return e.forEach((function(e){t.delete(e.ref)})),t.commit()}));case 4:return a.next=6,h.collection("votes").where("subreddit_id","==",e).get().then((function(e){var t=h.batch();return e.forEach((function(e){t.delete(e.ref)})),t.commit()}));case 6:return a.next=8,h.collection("comments").where("subreddit_id","==",e).get().then((function(e){var t=h.batch();return e.forEach((function(e){t.delete(e.ref)})),t.commit()}));case 8:return a.next=10,h.collection("subreddits").doc(e).delete();case 10:n({type:"DELETE_SUBREDDIT",payload:e}),t.push("/"),a.next=17;break;case 14:a.prev=14,a.t0=a.catch(1),console.error(a.t0.message);case 17:case"end":return a.stop()}}),a,null,[[1,14]])})));return function(e){return a.apply(this,arguments)}}()},fetchUsers:A,fetchVotes:T,fetchSubredditPosts:function(e){return function(){var t=Object(b.a)(f.a.mark((function t(a){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"CLEAR_POSTS"}),n=[],t.next=5,h.collection("posts").where("subreddit_id","==",e).get();case 5:t.sent.forEach((function(e){n.push(e.data())})),n=n.sort((function(e,t){return t.created_at-e.created_at})),console.log(n),a({type:"GET_POSTS",payload:n}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.error(t.t0.message);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()},fetchSubreddit:function(e){return function(){var t=Object(b.a)(f.a.mark((function t(a){var n,r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:"CLEAR_SUBREDDIT"}),n=e.name,t.prev=2,r={},t.next=6,h.collection("subreddits").where("name","==",n).get();case 6:t.sent.forEach((function(e){r=Object(p.a)({},e.data())})),a({type:"GET_SUBREDDIT",payload:r}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),console.error(t.t0.message);case 14:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}()}})((function(e){var t=e.fetchSubredditPosts,a=e.fetchSubreddit,s=e.fetchUsers,c=e.fetchVotes,o=e.deletePost,l=e.deleteSubreddit,u=e.subreddits,d=u.subreddit,m=u.isLoading,p=e.auth,v=p.currentUser,f=p.isLoggedIn,b=e.users.users,E=e.votes.votes,h=e.posts.posts,g=Object(i.h)(),N=Object(i.g)();Object(n.useEffect)((function(){a(g),s(),c()}),[a,s,c,g]),Object(n.useEffect)((function(){null!==d&&t(d.id)}),[t,d]);var O=Object(n.useState)(!1),_=Object(I.a)(O,2),j=_[0],y=_[1],x=Object(n.useState)(""),w=Object(I.a)(x,2),S=w[0],T=w[1];return r.a.createElement("div",null,r.a.createElement("div",{className:"hero is-success is-medium"},r.a.createElement("div",{className:"hero-body"},r.a.createElement("div",{className:"container"},m||null===d?r.a.createElement("h1",{className:"title"},"Loading..."):m||0!==Object.keys(d).length?r.a.createElement("h1",{className:" title is-capitalized"},d.name):r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:"is-capitalized"},"This Subreddit does not exist yet"),r.a.createElement("p",{className:"button is-warning"},"Create it Here")),null!==d&&v.id===d.user_id&&r.a.createElement("button",{className:"button is-danger",onClick:function(){return l(d.id,N)}},"Delete Subreddit")))),r.a.createElement(U,null,f&&r.a.createElement("button",{className:"button is-primary",onClick:function(){return y(!j)}},j?"Hide Form":"Add a Post"),j&&r.a.createElement(z,{toggleShowForm:y,subreddit:d.id}),r.a.createElement("form",{className:"form"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{type:"text",className:"input search-box",placeholder:"Search",value:S,onChange:function(e){return function(e){T(e.target.value)}(e)}}))),0!==h.length&&null!==d&&r.a.createElement(M,{users:b,votes:E,search:S,subreddit:d.name,subreddit_id:d.id,deletePost:o,posts:h,currentUser:v})))})),X=a(66),W=function(e){if(void 0===e)return"New Comment!";var t=1e3*e;return Object(X.a)(new Date(t),"MM-dd-yyyy HH:mm")},J=Object(m.b)(null,{updatePost:function(e,t){return function(){var a=Object(b.a)(f.a.mark((function a(n){var r,s;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,(r=Object(p.a)({},t)).updated_at=d.firestore.FieldValue.serverTimestamp(),a.next=5,h.collection("posts").doc(e).update(r);case 5:return a.next=7,h.collection("posts").doc(e).get().then((function(e){s=e.data()}));case 7:n({type:"CLEAR_POST"}),n({type:"UPDATE_POST",payload:s}),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(0),console.error(a.t0.message);case 14:case"end":return a.stop()}}),a,null,[[0,11]])})));return function(e){return a.apply(this,arguments)}}()}})((function(e){var t=e.updatePost,a=e.toggleShowForm,s=e.oldTitle,c=e.oldDesc,o=e.oldUrl,i=e.post_id,l=Object(n.useState)({title:s,desc:c,url:o}),u=Object(I.a)(l,2),d=u[0],m=u[1],v=d.title,f=d.desc,b=d.url,E=function(e){m(Object(p.a)(Object(p.a)({},d),{},Object(B.a)({},e.target.name,e.target.value)))};return r.a.createElement("form",{className:"post-form",onSubmit:function(e){return function(e){e.preventDefault(),t(i,d),a(!1)}(e)}},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{className:"input",placeholder:"Title",type:"text",value:v,name:"title",onChange:function(e){return E(e)}}))),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("textarea",{className:"textarea",placeholder:"Desc",type:"text",value:f,name:"desc",onChange:function(e){return E(e)}}))),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{className:"input",placeholder:"URL",type:"text",value:b,name:"url",onChange:function(e){return E(e)}}))),r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button is-primary"},"Update Post")))})),K=function(e){return function(){var t=Object(b.a)(f.a.mark((function t(a){var n,r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=h.collection("comments").doc(),(r=Object(p.a)({},e)).id=n.id,r.created_at=d.firestore.FieldValue.serverTimestamp(),r.updated_at=d.firestore.FieldValue.serverTimestamp(),t.prev=5,t.next=8,h.collection("comments").doc(r.id).set(r);case 8:a({type:"ADD_COMMENT",payload:r}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(5),console.error(t.t0.message);case 14:case"end":return t.stop()}}),t,null,[[5,11]])})));return function(e){return t.apply(this,arguments)}}()},q=function(e){return function(){var t=Object(b.a)(f.a.mark((function t(a){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h.collection("comments").doc(e).delete();case 3:a({type:"DELETE_COMMENT",payload:e}),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error(t.t0.message);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()},Y=Object(m.b)(null,{addComment:K})((function(e){var t=e.currentUser,a=e.subreddit_id,s=e.addComment,c=e.post_id,o=Object(n.useState)({content:""}),i=Object(I.a)(o,2),l=i[0],u=i[1],d=l.content;return r.a.createElement("form",{className:"post-form",onSubmit:function(e){return function(e){e.preventDefault();var n=t.id,r=Object(p.a)(Object(p.a)({},l),{},{user_id:n,post_id:c,subreddit_id:a,parent_id:null});s(r),u({content:""})}(e)}},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("textarea",{className:"textarea",placeholder:"Comment",value:d,name:"content",onChange:function(e){return function(e){u(Object(p.a)(Object(p.a)({},l),{},Object(B.a)({},e.target.name,e.target.value)))}(e)}}))),r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button is-primary"},"Comment")))})),Q=Object(m.b)(null,{addComment:K})((function(e){var t=e.currentUser,a=e.toggleReplyForm,s=e.subreddit_id,c=e.comment_id,o=e.addComment,i=e.post_id,l=Object(n.useState)({content:""}),u=Object(I.a)(l,2),d=u[0],m=u[1],v=d.content;return r.a.createElement("form",{className:"post-form",onSubmit:function(e){return function(e){e.preventDefault();var n=t.id,r=Object(p.a)(Object(p.a)({},d),{},{user_id:n,post_id:i,subreddit_id:s,parent_id:c});o(r),m({content:""}),a(!1)}(e)}},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("textarea",{className:"textarea",placeholder:"Reply",type:"text",value:v,name:"content",onChange:function(e){return function(e){m(Object(p.a)(Object(p.a)({},d),{},Object(B.a)({},e.target.name,e.target.value)))}(e)}}))),r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button is-primary is-small"},"Comment")))})),Z=Object(m.b)(null,{deleteComment:q})((function(e){var t=e.deleteComment,a=e.comment,n=e.currentUser,s={name:"Anonymous",image:"https://bulma.io/images/placeholders/96x96.png"};return void 0!==a.author&&(s.name=a.author.name,s.image=a.author.image),r.a.createElement("div",{className:"media my-2"},r.a.createElement("div",{className:"media-left"},r.a.createElement("figure",{className:"image"},r.a.createElement("img",{alt:"user avatar",src:s.image}))),r.a.createElement("div",{className:"media-content"},r.a.createElement("p",{className:"has-text-weight-bold"},s.name),r.a.createElement("p",null,a.content),r.a.createElement("div",{className:"level"},r.a.createElement("div",{className:"level-left"},r.a.createElement("div",{className:"level-item is-size-7"},r.a.createElement("span",{className:"created-at mr-2"},r.a.createElement("span",{className:"has-text-weight-bold"},"Created on:")," ",W(a.created_at.seconds)),r.a.createElement("span",{className:"updated-at ml-2"},r.a.createElement("span",{className:"has-text-weight-bold"},"Updated on:")," ",W(a.updated_at.seconds)))))),n.id===a.user_id&&r.a.createElement("button",{onClick:function(){return t(a.id)},className:"delete"},"X"))})),$=Object(m.b)((function(e){return{users:e.users,auth:e.auth}}),{fetchUsers:A,deleteComment:q})((function(e){var t=e.fetchUsers,a=e.currentUser,s=e.deleteComment,c=e.users.users,o=e.auth.isLoggedIn,i=e.comment,l=e.comments;Object(n.useEffect)((function(){t()}),[t]);var u,d,m=Object(n.useState)(!1),p=Object(I.a)(m,2),v=p[0],f=p[1];0!==c.length&&(u=(d=i.user_id,c.filter((function(e){return e.id===d})))[0]);var b=[];return b=function(e){var t=l.filter((function(t){return t.parent_id===e}));return t.map((function(e){e.author=c.filter((function(t){return t.id===e.user_id}))[0]})),t}(i.id),r.a.createElement("div",{className:"comment my-2"},r.a.createElement("div",{className:"media"},r.a.createElement("div",{className:"media-left"},r.a.createElement("figure",{className:"image"},r.a.createElement("img",{alt:"Author avatar",src:void 0!==u&&u.image}))),r.a.createElement("div",{className:"media-content"},r.a.createElement("p",{className:"has-text-weight-bold"},void 0!==u&&u.name),r.a.createElement("p",null,i.content),r.a.createElement("div",{className:"level"},r.a.createElement("div",{className:"level-left"},r.a.createElement("div",{className:"level-item is-size-7"},r.a.createElement("span",{className:"created-at mr-2"},r.a.createElement("span",{className:"has-text-weight-bold"},"Created on:")," ",W(i.created_at.seconds)),r.a.createElement("span",{className:"updated-at ml-2"},r.a.createElement("span",{className:"has-text-weight-bold"},"Updated on:")," ",W(i.updated_at.seconds))))),o&&r.a.createElement("button",{className:"button is-primary is-small",onClick:function(){return f(!v)}},"Reply"),v&&r.a.createElement("div",{className:"media"},r.a.createElement("div",{className:"media-content"},r.a.createElement(Q,{currentUser:a,subreddit_id:i.subreddit_id,comment_id:i.id,post_id:i.post_id,toggleReplyForm:f}))),0!==b.length&&void 0!==b[0].author&&b.map((function(e){return r.a.createElement(Z,{key:e.id,comment:e,currentUser:a})}))),a.id===i.user_id&&r.a.createElement("div",{className:"media-right"},r.a.createElement("button",{className:"delete",onClick:function(){return s(i.id)}},"X"))))})),ee=Object(m.b)((function(e){return{subreddits:e.subreddits,comments:e.comments,users:e.users,posts:e.posts,auth:e.auth,votes:e.votes}}),{fetchPost:function(e){return function(){var t=Object(b.a)(f.a.mark((function t(a){var n,r,s;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:"CLEAR_POST"}),t.prev=1,n={},t.next=5,h.collection("posts").doc(e).get().then((function(e){n=e.data()}));case 5:return r=n.user_id,t.next=8,h.collection("users").doc(r).get().then((function(e){n.author=e.data()}));case 8:return n.comments=[],t.next=11,h.collection("comments").where("post_id","==",e).get();case 11:return s=t.sent,t.next=14,s.forEach((function(e){n.comments.push(e.data())}));case 14:a({type:"GET_POST",payload:n}),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(1),console.error(t.t0.message);case 20:case"end":return t.stop()}}),t,null,[[1,17]])})));return function(e){return t.apply(this,arguments)}}()},fetchUsers:A,fetchPostVote:function(e){return function(){var t=Object(b.a)(f.a.mark((function t(a){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h.collection("votes").where("post_id","==",e).get();case 3:t.sent.forEach((function(e){n=e.data()})),a({type:"CLEAR_VOTE"}),a({type:"GET_VOTE",payload:n}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},fetchSubreddits:O,fetchPostComments:function(e){return function(){var t=Object(b.a)(f.a.mark((function t(a){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],t.prev=1,a({type:"CLEAR_COMMENTS"}),t.next=5,h.collection("comments").where("post_id","==",e).get();case 5:t.sent.forEach((function(e){n.push(e.data())})),n=n.sort((function(e,t){return t.created_at-e.created_at})),a({type:"GET_COMMENTS",payload:n}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),console.error(t.t0.message);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}()},upvote:C,downvote:k})((function(e){var t=e.fetchPost,a=e.fetchUsers,s=e.fetchPostVote,c=e.fetchSubreddits,l=e.fetchPostComments,u=e.upvote,d=e.downvote,m=e.votes.vote,p=e.posts.post,v=e.users.users,f=e.auth.currentUser,b=e.subreddits.subreddits,E=e.comments.comments,h=Object(i.h)(),g=h.post_id,N=h.name;Object(n.useEffect)((function(){t(g),c(),l(g),a(),s(g)}),[c,l,s,a,t,g]);var O,_=Object(n.useState)(!1),j=Object(I.a)(_,2),y=j[0],x=j[1],w="";0!==b.length&&(w=(O=N,b.filter((function(e){return e.name===O}))[0]).id);var S,T={name:"Anonymous",image:"https://bulma.io/images/placeholders/96x96.png",id:"rand0mnumb3rgen3r4t0r"};return null!==p&&(S=p.user_id,T=v.filter((function(e){return e.id===S}))[0]),r.a.createElement("section",null,r.a.createElement("div",{className:"hero is-warning"},r.a.createElement("div",{className:"hero-head mt-3",style:{marginLeft:"auto",marginRight:"auto"}},r.a.createElement("button",{className:"button is-success is-small ".concat(null!==m&&-1!==m.user_upvotes.indexOf(f.id)&&"is-light"),disabled:0===Object.entries(f).length,onClick:function(){return u(m.id,g,f.id,!0)}},"Upvote"),null!==m&&r.a.createElement("span",{className:"mx-3"},m.votes),r.a.createElement("button",{className:"button is-danger is-small ".concat(null!==m&&-1!==m.user_downvotes.indexOf(f.id)&&"is-light"),disabled:0===Object.entries(f).length,onClick:function(){return d(m.id,g,f.id,!0)}},"Downvote")),r.a.createElement("div",{className:"hero-body has-text-centered"},null!==p&&p.url&&r.a.createElement("figure",{className:"image",style:{margin:"0 auto",width:"35vw"}},r.a.createElement("img",{src:p.url,alt:""})),r.a.createElement("h1",{className:"title"},null!==p&&p.title),null!==p&&p.desc&&r.a.createElement("h2",{className:"subtitle"},p.desc)),r.a.createElement("div",{className:"hero-foot mb-3"},r.a.createElement("div",{className:"level is-size-6"},r.a.createElement("div",{className:"level-item has-text-centered"},r.a.createElement("figure",{className:"image is-24x24 mr-2",style:{marginBottom:0}},r.a.createElement("img",{className:"is-rounded",src:T.image,alt:""})),r.a.createElement(o.b,{to:"/u/".concat(T.id)},r.a.createElement("p",null,T.name))),r.a.createElement("div",{className:"level-item has-text-centered"},r.a.createElement("p",null,"Created: ",null!==p&&W(p.created_at.seconds))),r.a.createElement("div",{className:"level-item has-text-centered"},r.a.createElement("p",null,"Updated: ",null!==p&&W(p.updated_at.seconds)))))),r.a.createElement(U,null,null!==p&&f.id===p.user_id&&r.a.createElement("button",{className:"button is-success",onClick:function(){return x(!y)}},y?"Close Form":"Edit Post"),y&&null!==p&&r.a.createElement(J,{oldTitle:p.title,oldDesc:p.desc,oldUrl:p.url,post_id:p.id,toggleShowForm:x}),r.a.createElement("div",{className:"comments"},0!==E.length&&E.map((function(e){if(null===e.parent_id)return r.a.createElement($,{comment:e,comments:E,currentUser:f,key:e.id})})),r.a.createElement("div",{className:"mt-3 comment-form"},r.a.createElement("h2",{className:"subtitle"},"Add a Comment"),r.a.createElement(Y,{currentUser:f,post_id:g,name:N,subreddit_id:w})))))})),te=function(e){var t=e.post,a=e.user,n=e.subreddit,s=e.currentUser,c=e.vote_id,i=e.deletePost;return r.a.createElement("div",{className:"box"},r.a.createElement("div",{key:t.id,className:"media"},t.url&&r.a.createElement("div",{className:"media-left"},r.a.createElement("figure",{className:"image is-64x64"},r.a.createElement("img",{src:t.url,alt:t.title}))),r.a.createElement("div",{className:"media-content"},r.a.createElement("p",{className:"has-text-weight-bold"},void 0!==n&&r.a.createElement(o.b,{to:"/r/".concat(n.name,"/").concat(t.id)},t.title)),t.desc&&r.a.createElement("p",null,t.desc),r.a.createElement("div",{className:"level"},r.a.createElement("div",{className:"level-left"},r.a.createElement("div",{className:"level-item"},r.a.createElement("p",{className:"is-size-7"},void 0!==n&&r.a.createElement(o.b,{to:"/r/".concat(n.name)},n.name)))))),null!==a&&a.id===s.id&&r.a.createElement("div",{className:"media-right"},r.a.createElement("button",{className:"delete",onClick:function(){return i(t.id,c)}},"X"))))},ae=function(e){var t=e.comment,a=e.user,n=e.currentUser,s=e.deleteComment;return r.a.createElement("div",{key:t.id,className:"box"},r.a.createElement("div",{className:"media"},r.a.createElement("div",{className:"media-left"},r.a.createElement("figure",{className:"image is-64x64"},r.a.createElement("img",{src:a.image,alt:"user avatar"}))),r.a.createElement("div",{className:"media-content"},r.a.createElement("p",{className:"has-text-weight-bold"},a.name),r.a.createElement("p",null,t.content),r.a.createElement("div",{className:"level"},r.a.createElement("div",{className:"level-left"},r.a.createElement("div",{className:"level-item is-size-7"},r.a.createElement("span",{className:"created-at mr-2"},r.a.createElement("span",{className:"has-text-weight-bold"},"Created on:")," ",W(t.created_at.seconds)),r.a.createElement("span",{className:"updated-at ml-2"},r.a.createElement("span",{className:"has-text-weight-bold"},"Updated on:")," ",W(t.updated_at.seconds)))))),null!==a&&a.id===n.id&&r.a.createElement("div",{className:"media-right"},r.a.createElement("button",{className:"delete",onClick:function(){return s(t.id)}},"X"))))},ne=function(e){var t=e.updateUser,a=e.toggleUpdateUserForm,s=e.user,c=Object(n.useState)({name:s.name,bio:s.bio,image:s.image}),o=Object(I.a)(c,2),i=o[0],l=o[1],u=i.name,d=i.bio,m=i.image,v=function(e){l(Object(p.a)(Object(p.a)({},i),{},Object(B.a)({},e.target.name,e.target.value)))};return r.a.createElement("form",{className:"post-form",onSubmit:function(e){return function(e){e.preventDefault();var n=Object(p.a)({},i);n.id=s.id,t(n),a(!1)}(e)}},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{className:"input",placeholder:"Name",type:"text",value:u,name:"name",onChange:function(e){return v(e)},disabled:!0}))),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("textarea",{className:"textarea",placeholder:"Bio",type:"text",value:d,name:"bio",onChange:function(e){return v(e)}}))),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{className:"input",placeholder:"Image",type:"text",value:m,name:"image",onChange:function(e){return v(e)},disabled:!0}))),r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button is-primary"},"Update User")))},re=Object(m.b)((function(e){return{users:e.users,auth:e.auth,posts:e.posts,votes:e.votes,subreddits:e.subreddits,comments:e.comments}}),{deletePost:V,deleteComment:q,fetchUser:function(e){return function(){var t=Object(b.a)(f.a.mark((function t(a){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"CLEAR_USER"}),t.next=4,h.collection("users").doc(e).get().then((function(e){n=e.data()}));case 4:a({type:"GET_USER",payload:n}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0.message);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},updateUser:function(e){return function(){var t=Object(b.a)(f.a.mark((function t(a){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=Object(p.a)({},e)).updated_at=d.firestore.FieldValue.serverTimestamp(),t.next=5,h.collection("users").doc(n.id).update(e);case 5:a({type:"CLEAR_USER"}),a({type:"UPDATE_USER",payload:n}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},fetchVotes:T,fetchUserPosts:function(e){return function(){var t=Object(b.a)(f.a.mark((function t(a){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"CLEAR_POSTS"}),n=[],t.next=5,h.collection("posts").where("user_id","==",e).get();case 5:t.sent.forEach((function(e){n.push(e.data())})),a({type:"GET_POSTS",payload:n}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.error(t.t0.message);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()},fetchSubreddits:O,fetchUserComments:function(e){return function(){var t=Object(b.a)(f.a.mark((function t(a){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],t.prev=1,a({type:"CLEAR_COMMENTS"}),t.next=5,h.collection("comments").where("user_id","==",e).get();case 5:t.sent.forEach((function(e){n.push(e.data())})),n=n.sort((function(e,t){return t.created_at-e.created_at})),a({type:"GET_COMMENTS",payload:n}),t.next=13;break;case 11:t.prev=11,t.t0=t.catch(1);case 13:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}()}})((function(e){var t=e.deletePost,a=e.deleteComment,s=e.fetchUser,c=e.updateUser,o=e.fetchVotes,l=e.fetchUserPosts,u=e.fetchUserComments,d=e.fetchSubreddits,m=e.posts,p=m.posts,v=m.isLoading,f=e.comments.comments,b=e.users.user,E=e.auth.currentUser,h=e.subreddits.subreddits,g=e.votes.votes,N=Object(i.h)().user_id;Object(n.useEffect)((function(){s(N),l(N),u(N),d(),o()}),[l,d,u,o,s,N]);var O=Object(n.useState)(!0),_=Object(I.a)(O,2),j=_[0],y=_[1],x=Object(n.useState)(!1),w=Object(I.a)(x,2),S=w[0],T=w[1],C=Object(n.useState)(!1),k=Object(I.a)(C,2),L=k[0],D=k[1];return r.a.createElement(U,null,r.a.createElement("div",{className:"hero is-primary mb-5"},r.a.createElement("div",{className:"hero-body"},r.a.createElement("div",{className:"container has-text-centered"},r.a.createElement("figure",{className:"image is-128x128",style:{margin:"0 auto"}},r.a.createElement("img",{src:null!==b&&b.image&&b.image,alt:"User avatar"})),r.a.createElement("h1",{className:"title"},null!==b&&b.name),null!==b&&""!==b.bio&&r.a.createElement("h2",{className:"subtitle"},b.bio)))),null!==b&&b.id===E.id&&r.a.createElement("button",{className:"button is-small is-primary",onClick:function(){return D(!L)}},L?"Close Form":"Update User"),null!==b&&L&&r.a.createElement(ne,{user:b,updateUser:c,toggleUpdateUserForm:D}),r.a.createElement("div",{className:"buttons my-2"},r.a.createElement("button",{className:"button is-info ".concat(j&&"is-light"),disabled:j,onClick:function(){return y(!0),void T(!1)}},"User Posts"),r.a.createElement("button",{className:"button is-warning ".concat(S&&"is-light"),disabled:S,onClick:function(){return T(!0),void y(!1)}},"User Comments")),j&&r.a.createElement("div",{className:"user-posts"},0!==p.length&&!v&&p.map((function(e){var a,n,s=(a=e.id,g.filter((function(e){return e.post_id===a}))[0]),c=(n=e.subreddit_id,h.filter((function(e){return e.id===n}))[0]);return r.a.createElement(te,{vote_id:s,subreddit:c,currentUser:E,deletePost:t,user:b,post:e})}))),S&&r.a.createElement("div",{className:"user-comments"},0!==f.length&&!v&&f.map((function(e){return r.a.createElement(ae,{comment:e,user:b,currentUser:E,deleteComment:a})}))))})),se=function(e){var t=e.subreddit,a=e.post;return r.a.createElement("div",{className:"column is-4 post-column"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("p",{className:"is-capitalized card-header-title"},r.a.createElement(o.b,{to:"/r/".concat(t.name)},t.name))),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"media"},r.a.createElement("div",{className:"media-left"},r.a.createElement("figure",{className:"image is-96x96"},r.a.createElement("img",{src:a.url?a.url:"https://bulma.io/images/placeholders/96x96.png",alt:""}))),r.a.createElement("div",{className:"media-content"},r.a.createElement("p",{className:"title is-4"},r.a.createElement(o.b,{to:"/r/".concat(t.name,"/").concat(a.id)},a.title)))),a.desc&&r.a.createElement("div",{className:"content"},a.desc))))},ce=Object(m.b)((function(e){return{subreddits:e.subreddits,posts:e.posts}}),{fetchSubreddits:O,fetchAllPosts:P})((function(e){var t=e.fetchSubreddits,a=e.fetchAllPosts,s=e.posts.posts,c=e.subreddits.subreddits;Object(n.useEffect)((function(){t(),a()}),[t,a]);return r.a.createElement("section",null,r.a.createElement("div",{className:"hero is-warning is-medium"},r.a.createElement("div",{className:"hero-body"},r.a.createElement("div",{className:"container"},r.a.createElement("h1",{className:"title"},"Subreddits"),r.a.createElement("h2",null,"See the latest from each Subreddit")))),r.a.createElement(U,null,r.a.createElement("div",{className:"columns is-multiline is-4"},0!==c.length&&c.map((function(e){var t,a=(t=e.id,s.filter((function(e){return e.subreddit_id===t}))[0]);return void 0===a&&(a={title:"Nothing here yet!",url:"https://bulma.io/images/placeholders/96x96.png",user_id:"none",subreddit_id:e.id,id:"none",desc:"Be the first to post in this subreddit!",created_at:{seconds:0,nanoseconds:0},updated_at:{seconds:0,nanoseconds:0}}),r.a.createElement(se,{key:e.id,subreddit:e,post:a})})))))})),oe=Object(m.b)((function(e){return{auth:e.auth}}),{createSubreddit:function(e,t){return function(){var a=Object(b.a)(f.a.mark((function a(n){var r,s;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,r=h.collection("subreddits").doc(),(s=Object(p.a)({},e)).id=r.id,s.created_at=d.firestore.FieldValue.serverTimestamp(),a.next=7,h.collection("subreddits").doc(s.id).set(s);case 7:n({type:"CREATE_SUBREDDIT",payload:s}),t&&t.push("/r/".concat(s.name)),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(0),console.error(a.t0.message);case 14:case"end":return a.stop()}}),a,null,[[0,11]])})));return function(e){return a.apply(this,arguments)}}()}})((function(e){var t=e.createSubreddit,a=e.auth.currentUser,s=Object(n.useState)({name:"",desc:""}),c=Object(I.a)(s,2),o=c[0],l=c[1],u=o.name,d=o.desc,m=Object(i.g)(),v=function(e){l(Object(p.a)(Object(p.a)({},o),{},Object(B.a)({},e.target.name,e.target.value)))};return r.a.createElement(U,null,r.a.createElement("h1",{className:"has-text-centered is-title"},"Create a Subreddit"),r.a.createElement("form",{className:"create-sub-form",onSubmit:function(e){return function(e){e.preventDefault();var n=a.id,r=o.name.toLowerCase(),s={name:r=r.replaceAll(/\W/g,""),desc:o.desc,user_id:n};t(s,m),l({name:"",desc:""})}(e)}},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("label",{className:"label"},"Name"),r.a.createElement("input",{className:"input",type:"text",name:"name",value:u,placeholder:"Name the Subreddit",onChange:function(e){return v(e)},maxLength:"20"}))),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("label",{className:"label"},"Description"),r.a.createElement("textarea",{className:"textarea",type:"textarea",name:"desc",value:d,placeholder:"Describe the Subreddit",onChange:function(e){return v(e)},maxLength:"140"}))),r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button is-primary"},"Create Subreddit"))))})),ie=a(38),le=a(19),ue=a(11),de={users:[],user:null,isLoading:!0},me={currentUser:{},isLoggedIn:!1,isLoading:!0},pe={posts:[],post:null,isLoading:!0},ve={subreddits:[],subreddit:null,isLoading:!0},fe={comments:[],isLoading:!0},be={votes:[],vote:null,isLoading:!0},Ee=Object(le.combineReducers)({users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"GET_USERS":return Object(p.a)(Object(p.a)({},e),{},{users:Object(ue.a)(n),isLoading:!1});case"GET_USER":case"UPDATE_USER":return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,user:n});case"CLEAR_USER":return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,user:null});default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"LOGIN_USER":case"GET_CURRENT_USER":return Object(p.a)(Object(p.a)({},e),{},{currentUser:Object(p.a)({},n),isLoggedIn:!0,isLoading:!1});case"LOGOUT_USER":case"LOGIN_FAIL":return Object(p.a)(Object(p.a)({},e),{},{currentUser:{},isLoggedIn:!1,isLoading:!1});default:return e}},posts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"GET_POSTS":return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,posts:Object(ue.a)(n)});case"GET_POST":return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,post:n});case"CREATE_POST":return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,posts:[n].concat(Object(ue.a)(e.posts))});case"UPDATE_POST":var r=e.posts.filter((function(e){return e.id!==n.id}));return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,posts:[].concat(Object(ue.a)(r),[n]),post:n});case"DELETE_POST":var s=e.posts.filter((function(e){return e.id!==n}));return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,posts:Object(ue.a)(s)});case"CLEAR_POST":return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,post:null});case"CLEAR_POSTS":return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,posts:[]});default:return e}},subreddits:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"GET_SUBREDDITS":return Object(p.a)(Object(p.a)({},e),{},{subreddits:n,isLoading:!1});case"GET_SUBREDDIT":return Object(p.a)(Object(p.a)({},e),{},{subreddit:n,isLoading:!1});case"CREATE_SUBREDDIT":return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,subreddits:[].concat(Object(ue.a)(e.subreddits),[n])});case"UPDATE_SUBREDDIT":var r=e.subreddits.filter((function(e){return e.id!==n.id}));return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,subreddits:[].concat(Object(ue.a)(r),[n])});case"DELETE_SUBREDDIT":var s=e.subreddits.filter((function(e){return e.id!==n}));return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,subreddits:Object(ue.a)(s)});case"CLEAR_SUBREDDIT":return Object(p.a)(Object(p.a)({},e),{},{subreddit:null,isLoading:!1});default:return e}},comments:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"GET_COMMENTS":return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,comments:n});case"ADD_COMMENT":return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,comments:[].concat(Object(ue.a)(e.comments),[n])});case"DELETE_COMMENT":var r=e.comments.filter((function(e){return e.id!==n}));return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,comments:Object(ue.a)(r)});case"CLEAR_COMMENTS":return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,comments:[]});default:return e}},votes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"GET_VOTES":return Object(p.a)(Object(p.a)({},e),{},{votes:Object(ue.a)(n),isLoading:!1});case"GET_VOTE":return Object(p.a)(Object(p.a)({},e),{},{vote:n,isLoading:!1});case"ADD_VOTES":return Object(p.a)(Object(p.a)({},e),{},{votes:[].concat(Object(ue.a)(e.votes),[n]),isLoading:!1});case"ADD_VOTE":var r=e.votes.filter((function(e){return e.id!==n.id}));return Object(p.a)(Object(p.a)({},e),{},{votes:[].concat(Object(ue.a)(r),[n]),isLoading:!1});case"REMOVE_VOTE":var s=e.votes.filter((function(e){return e.id!==n.id}));return Object(p.a)(Object(p.a)({},e),{},{votes:[].concat(Object(ue.a)(s),[n]),isLoading:!1});case"DELETE_VOTE":var c=e.votes.filter((function(e){return e.id!==n}));return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,votes:Object(ue.a)(c)});case"CLEAR_VOTE":return Object(p.a)(Object(p.a)({},e),{},{isLoading:!1,vote:null});default:return e}}}),he=[a(39).a],ge=Object(le.createStore)(Ee,{},Object(ie.composeWithDevTools)(le.applyMiddleware.apply(void 0,he)));var Ne=function(){return Object(n.useEffect)((function(){d.auth().onAuthStateChanged((function(e){if(e){var t={name:e.displayName,id:e.uid,image:e.photoURL};ge.dispatch(function(e){return function(){var t=Object(b.a)(f.a.mark((function t(a){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:"GET_CURRENT_USER",payload:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))}else ge.dispatch((function(e){e({type:"LOGIN_FAIL"})}))}))})),r.a.createElement(o.a,null,r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"content"},r.a.createElement(j,null),r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:"/",component:F}),r.a.createElement(w,{exact:!0,path:"/create-a-subreddit",component:oe}),r.a.createElement(i.b,{exact:!0,path:"/r/index",component:ce}),r.a.createElement(i.b,{exact:!0,path:"/r/:name",component:H}),r.a.createElement(i.b,{exact:!0,path:"/r/:name/:post_id",component:ee}),r.a.createElement(i.b,{exact:!0,path:"/u/:user_id",component:re})))),r.a.createElement(y,null))};c.a.render(r.a.createElement(m.a,{store:ge},r.a.createElement(Ne,null)),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.a506ef05.chunk.js.map